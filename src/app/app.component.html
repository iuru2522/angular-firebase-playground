<mat-toolbar color="primary" class="main-toolbar">
  <div class="nav-links">
    <a mat-button routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">
      <mat-icon>home</mat-icon>
      Home
    </a>
    @if (isAuthenticated()) {
      <a mat-button routerLink="/dashboard" routerLinkActive="active">
        <mat-icon>dashboard</mat-icon>
        Dashboard
      </a>
    }
  </div>

  <span class="toolbar-spacer"></span>

  <div class="nav-auth-status">
    @if (isLoading()) {
      <span class="loading">Loading...</span>
    } @else if (error()) {
      <span class="error">Error: {{ error() }}</span>
    } @else if (isAuthenticated()) {
      <div class="user-info">
        <span>Welcome, {{ user()?.displayName || user()?.email }}</span>
        <button mat-raised-button color="warn" (click)="logout()">
          <mat-icon>logout</mat-icon>
          Logout
        </button>
      </div>
    } @else {
      <div class="auth-buttons">
        <button mat-raised-button color="accent" (click)="signIn()">
          <mat-icon>login</mat-icon>
          Sign In
        </button>
        <button mat-raised-button (click)="signUp()">
          <mat-icon>person_add</mat-icon>
          Sign Up
        </button>
      </div>
    }
  </div>
</mat-toolbar>

@if (showOfflineFallback()) {
  <app-offline-fallback />
} @else {
  <div class="app-container">
    <main class="app-main">
      @if (!firebaseReady()) {
        <div class="loading-container">
          <div class="spinner"></div>
          <p>Initializing Firebase...</p>
        </div>
      } @else {
        <router-outlet />
      }
    </main>
  </div>
}